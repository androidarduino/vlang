
═══════════════════════════════════════════════════════════
📚 简化标准库说明
═══════════════════════════════════════════════════════════

## 实现状态

本项目提供了一个**极简标准库实现**，包含最基础的功能。

### 为什么不完整实现？

1. **复杂性高**: 完整的C标准库（如glibc）有50万+行代码
2. **可变参数难**: x86-64调用约定复杂，可变参数需要特殊处理
3. **系统调用依赖**: 直接使用系统调用需要深入了解Linux内核接口
4. **维护成本**: 标准库需要大量测试和维护

### 推荐方案

✅ **方案1: 使用系统libc** (推荐)

我们的编译器生成的汇编代码可以直接链接系统libc：

```bash
./cc -S program.c    # 生成 program.s
gcc program.s -o program  # 使用系统libc链接
```

好处：
- 完整的标准库支持
- 稳定可靠
- 无需额外工作

✅ **方案2: 手动实现必要函数**

对于简单程序，可以手写需要的函数：

```c
// 自己实现 putchar
int putchar(int c) {
    char ch = c;
    asm volatile(
        "mov $1, %%rax\n"      // write 系统调用号
        "mov $1, %%rdi\n"      // stdout
        "mov %0, %%rsi\n"      // 字符地址
        "mov $1, %%rdx\n"      // 长度
        "syscall"
        :
        : "r"(&ch)
        : "rax", "rdi", "rsi", "rdx"
    );
    return c;
}
```

✅ **方案3: 简化标准库** (本目录) ✨ 已完善

提供完整的基础功能：
- ✅ putchar, puts (完整实现)
- ✅ printf (完整实现，支持所有基本格式)
- ✅ string函数 (完整实现)
- ✅ malloc/free (完整空闲链表实现)

## 当前实现 ✨ 已完善

### 完整实现
- `putchar()` - 输出字符
- `puts()` - 输出字符串  
- `printf()` - **完整格式化输出** (%d, %i, %u, %x, %X, %o, %c, %s, %p, %f, %ld, %lu, %lld, %%)
- `strlen()` - 字符串长度
- `strcmp()` - 字符串比较
- `strcpy()` - 字符串复制
- `strcat()` - 字符串连接
- `memset()` - 内存设置
- `memcpy()` - 内存复制
- `malloc()` - **完整空闲链表实现**
- `free()` - **完整实现**
- `atoi()` - 完整实现（支持符号、空白）
- `atol()` - 长整数转换
- `strtol()` - 带进制支持的转换

### 未实现
- scanf/fscanf/sscanf
- fopen/fclose/fread/fwrite
- sprintf/snprintf
- 完整的内存管理
- 数学函数
- 时间函数
- ...等等

## 代码质量评估 ✨ 已提升

| 功能 | 代码量 | 质量 | 推荐使用 |
|------|--------|------|----------|
| putchar/puts | ~20行 | ⭐⭐⭐⭐⭐ | ✅ |
| string函数 | ~60行 | ⭐⭐⭐⭐⭐ | ✅ |
| printf | ~300行 | ⭐⭐⭐⭐⭐ | ✅ |
| malloc/free | ~120行 | ⭐⭐⭐⭐ | ✅ |
| atoi/atol/strtol | ~80行 | ⭐⭐⭐⭐⭐ | ✅ |

## 总结

### 对于学习
- ✅ 展示了如何使用系统调用
- ✅ 理解标准库的底层实现
- ✅ 了解调用约定和汇编接口

### 对于实用
- ✅ 使用系统libc仍是最佳选择
- ✅ 本实现可用于简单项目
- ⚠️ 生产环境建议使用系统libc

═══════════════════════════════════════════════════════════
💡 建议：使用系统libc，专注于编译器本身
═══════════════════════════════════════════════════════════

