# ğŸ‰ ç¼–è¯‘å™¨å½“å‰çŠ¶æ€

## âœ… å·²å®Œæˆçš„é˜¶æ®µ

### 1. è¯æ³•åˆ†æ (Lexical Analysis)
- æ–‡ä»¶: `c_lexer_ast.l`
- åŠŸèƒ½: å°†æºä»£ç è½¬æ¢ä¸º token æµ
- æ”¯æŒ: å…³é”®å­—ã€æ ‡è¯†ç¬¦ã€å­—é¢é‡ã€è¿ç®—ç¬¦

### 2. è¯­æ³•åˆ†æ (Syntax Analysis)  
- æ–‡ä»¶: `c_parser_ast_no_main.y`
- åŠŸèƒ½: éªŒè¯è¯­æ³•å¹¶æ„å»º AST
- æ”¯æŒ: å‡½æ•°ã€å£°æ˜ã€è¯­å¥ã€è¡¨è¾¾å¼

### 3. AST æ„å»º (Abstract Syntax Tree)
- æ–‡ä»¶: `ast.h`, `ast.c`
- åŠŸèƒ½: ç¨‹åºçš„ç»“æ„åŒ–è¡¨ç¤º
- ç‰¹æ€§: 22ç§èŠ‚ç‚¹ç±»å‹ï¼Œæ ‘å½¢ç»“æ„ï¼Œå¯è§†åŒ–è¾“å‡º

### 4. è¯­ä¹‰åˆ†æ (Semantic Analysis) âœ¨ æ–°å¢ï¼
- æ–‡ä»¶: `semantic.h`, `semantic.c`, `symbol_table.h`, `symbol_table.c`, `types.h`, `types.c`
- åŠŸèƒ½: 
  - âœ… ç¬¦å·è¡¨ç®¡ç†
  - âœ… ç±»å‹æ£€æŸ¥
  - âœ… ä½œç”¨åŸŸç®¡ç†
  - âœ… é”™è¯¯æ£€æµ‹ï¼ˆæœªå£°æ˜å˜é‡ç­‰ï¼‰
  - âœ… ç±»å‹å…¼å®¹æ€§æ£€æŸ¥

## ğŸ“Š ç¼–è¯‘å™¨å½“å‰èƒ½åŠ›

### æ”¯æŒçš„ç‰¹æ€§
- âœ… åŸºæœ¬ç±»å‹ï¼šint, float, char, void
- âœ… å˜é‡å£°æ˜å’Œåˆå§‹åŒ–
- âœ… ç®—æœ¯è¿ç®—ï¼š+, -, *, /, %
- âœ… å…³ç³»è¿ç®—ï¼š<, >, <=, >=, ==, !=
- âœ… èµ‹å€¼è¯­å¥
- âœ… if-else è¯­å¥
- âœ… while å¾ªç¯
- âœ… return è¯­å¥
- âœ… å‡½æ•°å®šä¹‰
- âœ… å¤åˆè¯­å¥ï¼ˆä»£ç å—ï¼‰

### é”™è¯¯æ£€æµ‹èƒ½åŠ›
- âœ… æ£€æµ‹æœªå£°æ˜çš„å˜é‡
- âœ… æ£€æµ‹ç±»å‹ä¸åŒ¹é…
- âœ… æ£€æµ‹é‡å¤å£°æ˜
- âœ… å‹å¥½çš„é”™è¯¯æ¶ˆæ¯ï¼ˆå¸¦è¡Œå·ï¼‰

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### ç¼–è¯‘ç¼–è¯‘å™¨
```bash
bison -y -d c_parser_ast_no_main.y
flex c_lexer_ast.l
gcc -o c_compiler_semantic y.tab.c lex.yy.c ast.c types.c symbol_table.c semantic.c c_compiler_semantic.c -lfl
```

### è¿è¡Œç¼–è¯‘å™¨
```bash
./c_compiler_semantic < your_program.c
```

### ç¤ºä¾‹
```c
// æ­£ç¡®çš„ç¨‹åº
int main() {
    int x;
    x = 10 + 5;
    return 0;
}
// è¾“å‡ºï¼šâœ“ Semantic analysis successful!

// æœ‰é”™è¯¯çš„ç¨‹åº
int main() {
    x = 10;  // æœªå£°æ˜
    return 0;
}
// è¾“å‡ºï¼šSemantic Error: Undeclared variable: x
```

## ğŸš€ ä¸‹ä¸€æ­¥ï¼šä¸­é—´ä»£ç ç”Ÿæˆ

ç°åœ¨ç¼–è¯‘å™¨å·²ç»å®Œæˆäº†å‰ç«¯çš„æ‰€æœ‰å·¥ä½œã€‚ä¸‹ä¸€æ­¥æ˜¯**ä¸­é—´ä»£ç ç”Ÿæˆ**ï¼š

### é€‰é¡¹ 1: ä¸‰åœ°å€ç  (TAC) - æ¨è
å°† AST è½¬æ¢ä¸ºç®€å•çš„ä¸‰åœ°å€ç æŒ‡ä»¤ï¼š
```
// æºä»£ç 
x = a + b * c;

// ä¸‰åœ°å€ç 
t1 = b * c
t2 = a + t1
x = t2
```

**ä¼˜ç‚¹**ï¼š
- ç®€å•æ˜“æ‡‚
- æ˜“äºä¼˜åŒ–
- ç‹¬ç«‹äºç›®æ ‡å¹³å°

**éœ€è¦åˆ›å»º**ï¼š
- `ir.h` / `ir.c` - IR æ•°æ®ç»“æ„
- `ir_gen.h` / `ir_gen.c` - IR ç”Ÿæˆå™¨

**é¢„è®¡æ—¶é—´**ï¼š3-4 å¤©

### é€‰é¡¹ 2: æ ˆå¼è™šæ‹Ÿæœº - æ›´ç®€å•
ç›´æ¥ç”ŸæˆåŸºäºæ ˆçš„å­—èŠ‚ç ï¼š
```
push a
push b
push c
mul
add
store x
```

**ä¼˜ç‚¹**ï¼š
- æ›´ç®€å•å®ç°
- å¯ä»¥ç›´æ¥è§£é‡Šæ‰§è¡Œ
- é€‚åˆå­¦ä¹ 

**éœ€è¦åˆ›å»º**ï¼š
- `vm.h` / `vm.c` - è™šæ‹Ÿæœº
- `bytecode_gen.h` / `bytecode_gen.c` - å­—èŠ‚ç ç”Ÿæˆ

**é¢„è®¡æ—¶é—´**ï¼š2-3 å¤©

### é€‰é¡¹ 3: ç›´æ¥ç”Ÿæˆæ±‡ç¼– - æœ€ç»ˆç›®æ ‡
è·³è¿‡ IRï¼Œç›´æ¥ç”Ÿæˆ x86-64 æ±‡ç¼–ï¼š

**ä¼˜ç‚¹**ï¼š
- ç›´æ¥ç”Ÿæˆå¯æ‰§è¡Œä»£ç 
- å­¦ä¹ æ±‡ç¼–ç¼–ç¨‹

**ç¼ºç‚¹**ï¼š
- æ›´å¤æ‚
- éš¾ä»¥ä¼˜åŒ–
- å¹³å°ç›¸å…³

**é¢„è®¡æ—¶é—´**ï¼š5-7 å¤©

## ğŸ’¡ æˆ‘çš„å»ºè®®

**è·¯å¾„ A: å¿«é€ŸåŸå‹ï¼ˆæ¨èåˆå­¦è€…ï¼‰**
```
å½“å‰çŠ¶æ€ â†’ æ ˆå¼è™šæ‹Ÿæœº â†’ ä¼˜åŒ– â†’ æ±‡ç¼–ç”Ÿæˆ
           (2-3å¤©)      (2å¤©)   (5å¤©)
```

**è·¯å¾„ B: æ ‡å‡†ç¼–è¯‘å™¨ï¼ˆæ¨èå®Œæ•´å­¦ä¹ ï¼‰**
```
å½“å‰çŠ¶æ€ â†’ ä¸‰åœ°å€ç  â†’ ä¼˜åŒ– â†’ æ±‡ç¼–ç”Ÿæˆ
           (3-4å¤©)    (3å¤©)   (5å¤©)
```

**è·¯å¾„ C: å¿«é€Ÿåˆ°æ±‡ç¼–ï¼ˆé€‚åˆæœ‰ç»éªŒè€…ï¼‰**
```
å½“å‰çŠ¶æ€ â†’ ç›´æ¥æ±‡ç¼–ç”Ÿæˆ
           (5-7å¤©)
```

## ğŸ“ é¡¹ç›®æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒæ–‡ä»¶
- âœ… `ast.h` / `ast.c` - AST å®šä¹‰å’Œæ“ä½œ
- âœ… `types.h` / `types.c` - ç±»å‹ç³»ç»Ÿ
- âœ… `symbol_table.h` / `symbol_table.c` - ç¬¦å·è¡¨
- âœ… `semantic.h` / `semantic.c` - è¯­ä¹‰åˆ†æ
- âœ… `c_lexer_ast.l` - Lexer
- âœ… `c_parser_ast_no_main.y` - Parser
- âœ… `c_compiler_semantic.c` - ä¸»ç¨‹åº
- âœ… `c_compiler_semantic` - å¯æ‰§è¡Œæ–‡ä»¶

### æ–‡æ¡£æ–‡ä»¶
- âœ… `AST_README.md` - AST è¯´æ˜
- âœ… `COMPILER_ROADMAP.md` - å¼€å‘è·¯çº¿å›¾
- âœ… `COMPILER_ARCHITECTURE.md` - æ¶æ„æ–‡æ¡£
- âœ… `OPTIMIZATION_REPORT.md` - è¯­æ³•ä¼˜åŒ–æŠ¥å‘Š
- âœ… `NEXT_STEPS.md` - æœ¬æ–‡æ¡£

### å¤‡ä»½å’Œæµ‹è¯•
- `c_parser.y.backup` - åŸå§‹ parser å¤‡ä»½
- `c_parser.y` / `c_lexer.l` - åŸå§‹å®Œæ•´ç‰ˆæœ¬

## ğŸ“ æ‚¨å­¦åˆ°äº†ä»€ä¹ˆ

1. **Flex/Lex** - è¯æ³•åˆ†æå™¨ç”Ÿæˆ
2. **Bison/Yacc** - è¯­æ³•åˆ†æå™¨ç”Ÿæˆ
3. **AST æ„å»º** - ç¨‹åºçš„ç»“æ„åŒ–è¡¨ç¤º
4. **ç¬¦å·è¡¨** - æ ‡è¯†ç¬¦ä¿¡æ¯ç®¡ç†
5. **ç±»å‹ç³»ç»Ÿ** - ç±»å‹è¡¨ç¤ºå’Œæ£€æŸ¥
6. **è¯­ä¹‰åˆ†æ** - æ·±å±‚è¯­ä¹‰è§„åˆ™éªŒè¯

## ğŸ”¥ å‡†å¤‡å¥½ç»§ç»­äº†å—ï¼Ÿ

è¯·é€‰æ‹©æ‚¨æƒ³è¦çš„ä¸‹ä¸€æ­¥ï¼š

1. **å®ç°æ ˆå¼è™šæ‹Ÿæœº** - æœ€å¿«çœ‹åˆ°è¿è¡Œç»“æœ
2. **å®ç°ä¸‰åœ°å€ç ç”Ÿæˆå™¨** - æ ‡å‡†ç¼–è¯‘å™¨æµç¨‹
3. **å®ç°ç®€å•çš„ä»£ç ä¼˜åŒ–å™¨** - è®©ä»£ç æ›´é«˜æ•ˆ
4. **ç›´æ¥ç”Ÿæˆ x86-64 æ±‡ç¼–** - ç»ˆæç›®æ ‡

å‘Šè¯‰æˆ‘æ‚¨çš„é€‰æ‹©ï¼Œæˆ‘ä¼šç«‹å³å¼€å§‹å®ç°ï¼
